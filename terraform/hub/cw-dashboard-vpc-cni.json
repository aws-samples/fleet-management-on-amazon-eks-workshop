{
    "variables": [
        {
            "type": "property",
            "property": "CLUSTER_ID",
            "inputType": "select",
            "id": "CLUSTER_ID",
            "label": "EKS Cluster",
            "defaultValue": "fleet-hub-cluster",
            "visible": true,
            "search": "{Kubernetes,CLUSTER_ID} MetricName=assignIPAddresses",
            "populateFrom": "CLUSTER_ID"
        }
    ],
    "widgets": [
        {
            "height": 6,
            "width": 20,
            "y": 6,
            "x": 0,
            "type": "metric",
            "properties": {
                "view": "singleValue",
                "stacked": false,
                "region": "**aws_region**",
                "metrics": [
                    [ "Kubernetes", "eniAllocated", "CLUSTER_ID", "${CLUSTER_ID}", { "id": "m1" } ],
                    [ ".", "forceRemoveENI", ".", ".", { "id": "m3" } ],
                    [ ".", "eniMaxAvailable", ".", ".", { "id": "m4" } ],
                    [ ".", "awsAPILatency", ".", ".", { "id": "m5" } ],
                    [ ".", "ec2ApiReqCount", ".", ".", { "id": "m6" } ],
                    [ ".", "totalIPv4Prefixes", ".", ".", { "id": "m7" } ],
                    [ ".", "delReqCount", ".", ".", { "id": "m8" } ],
                    [ ".", "maxIPAddresses", ".", ".", { "id": "m9" } ],
                    [ ".", "ipamdActionInProgress", ".", ".", { "id": "m11" } ],
                    [ ".", "addReqCount", ".", ".", { "id": "m12" } ],
                    [ ".", "assignIPAddresses", ".", ".", { "id": "m13" } ],
                    [ ".", "totalIPAddresses", ".", ".", { "id": "m14" } ],
                    [ ".", "reconcileCount", ".", ".", { "id": "m15" } ],
                    [ ".", "forceRemoveIPs", ".", ".", { "id": "m25" } ],
                    [ ".", "totalAssignedIPv4sPerCidr", ".", ".", { "id": "m45" } ]
                ],
                "stat": "Average",
                "period": 300,
                "title": "CNI Network Metrics"
            }
        },
        {
            "height": 6,
            "width": 8,
            "y": 0,
            "x": 6,
            "type": "metric",
            "properties": {
                "metrics": [
                    [ { "expression": "100*m1/m2", "label": "eniUtilization", "id": "e1" } ],
                    [ "Kubernetes", "eniAllocated", "CLUSTER_ID", "${CLUSTER_ID}", { "id": "m1", "visible": false } ],
                    [ ".", "eniMaxAvailable", ".", ".", { "id": "m2", "visible": false } ]
                ],
                "sparkline": true,
                "view": "gauge",
                "region": "**aws_region**",
                "stat": "Average",
                "period": 300,
                "title": "ENIs utilization",
                "yAxis": {
                    "left": {
                        "min": 0,
                        "max": 100
                    }
                }
            }
        },
        {
            "height": 3,
            "width": 6,
            "y": 0,
            "x": 0,
            "type": "metric",
            "properties": {
                "sparkline": true,
                "view": "singleValue",
                "metrics": [
                    [ "Kubernetes", "eniAllocated", "CLUSTER_ID", "${CLUSTER_ID}" ]
                ],
                "region": "**aws_region**",
                "setPeriodToTimeRange": true,
                "title": "ENIs - Allocated"
            }
        },
        {
            "height": 3,
            "width": 6,
            "y": 3,
            "x": 0,
            "type": "metric",
            "properties": {
                "sparkline": true,
                "view": "singleValue",
                "metrics": [
                    [ "Kubernetes", "eniMaxAvailable", "CLUSTER_ID", "${CLUSTER_ID}" ]
                ],
                "region": "**aws_region**",
                "setPeriodToTimeRange": true,
                "title": "ENIs - Max available"
            }
        },
        {
            "height": 6,
            "width": 6,
            "y": 0,
            "x": 14,
            "type": "metric",
            "properties": {
                "metrics": [
                    [ "Kubernetes", "ec2ApiReqCount", "CLUSTER_ID", "${CLUSTER_ID}" ]
                ],
                "view": "timeSeries",
                "stacked": false,
                "region": "**aws_region**",
                "stat": "Sum",
                "period": 300,
                "title": "EC2 API request count"
            }
        }
    ]
}